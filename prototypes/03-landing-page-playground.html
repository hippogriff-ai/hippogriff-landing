<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hippogriff — Landing Page Playground</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
    background: #0e0e0e;
    color: #ccc;
    height: 100vh;
    display: grid;
    grid-template-columns: 340px 1fr;
    grid-template-rows: 1fr auto;
    overflow: hidden;
  }

  ::-webkit-scrollbar { width: 5px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: #555; }

  /* ── Controls Panel ── */
  .controls {
    grid-row: 1 / 3;
    background: #141414;
    border-right: 1px solid #222;
    padding: 20px 18px;
    overflow-y: auto;
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }
  .panel-header h1 { font-size: 12px; text-transform: uppercase; letter-spacing: 2px; color: #666; }
  .panel-header .version { font-size: 10px; color: #444; font-family: 'SF Mono', 'Fira Code', monospace; }

  .group { margin-bottom: 22px; }
  .group-title {
    font-size: 10px; text-transform: uppercase; letter-spacing: 1.5px; color: #555;
    margin-bottom: 10px; display: flex; align-items: center; gap: 6px;
  }
  .group-title::after { content: ''; flex: 1; height: 1px; background: #222; }

  .control { margin-bottom: 12px; }
  .control label {
    display: flex; justify-content: space-between; align-items: center;
    font-size: 12px; color: #888; margin-bottom: 4px;
  }
  .control label span.val { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 11px; color: #555; }

  input[type="range"] { width: 100%; accent-color: #f5c542; cursor: pointer; height: 4px; }
  input[type="color"] { width: 32px; height: 24px; border: 1px solid #333; border-radius: 4px; background: transparent; cursor: pointer; padding: 0; }

  .color-row { display: flex; align-items: center; gap: 8px; }
  .color-row input[type="text"] {
    flex: 1; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 4px 8px; color: #aaa; font-family: 'SF Mono', 'Fira Code', monospace; font-size: 11px;
  }
  .color-row input[type="text"]:focus { outline: none; border-color: #444; }

  .swatch-strip { display: flex; gap: 0; border-radius: 4px; overflow: hidden; height: 28px; margin-bottom: 12px; border: 1px solid #222; }
  .swatch-strip div { flex: 1; }

  .presets { display: flex; flex-wrap: wrap; gap: 4px; }
  .preset-btn {
    background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 5px 10px; color: #888; font-size: 11px; cursor: pointer; transition: all 0.15s;
  }
  .preset-btn:hover { border-color: #f5c542; color: #ccc; }
  .preset-btn.active { border-color: #f5c542; background: #1f1b10; color: #f5c542; }

  select {
    width: 100%; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 5px 8px; color: #aaa; font-size: 12px;
  }
  select:focus { outline: none; border-color: #444; }

  .text-input {
    width: 100%; background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 5px 8px; color: #aaa; font-size: 12px;
  }
  .text-input:focus { outline: none; border-color: #444; }
  textarea.text-input { resize: vertical; min-height: 48px; font-family: inherit; line-height: 1.4; }

  .toggle-row { display: flex; justify-content: space-between; align-items: center; padding: 4px 0; }
  .toggle-row label { font-size: 12px; color: #888; margin: 0; }
  .toggle { position: relative; width: 36px; height: 20px; cursor: pointer; }
  .toggle input { opacity: 0; width: 0; height: 0; }
  .toggle .slider {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    background: #2a2a2a; border-radius: 10px; transition: 0.2s;
  }
  .toggle .slider::before {
    content: ''; position: absolute; width: 16px; height: 16px; left: 2px; bottom: 2px;
    background: #666; border-radius: 50%; transition: 0.2s;
  }
  .toggle input:checked + .slider { background: #3a3018; }
  .toggle input:checked + .slider::before { transform: translateX(16px); background: #f5c542; }

  .collapsible-header { cursor: pointer; user-select: none; }
  .collapsible-header .group-title::before { content: '\25B8'; font-size: 9px; color: #444; transition: transform 0.2s; display: inline-block; }
  .collapsible-header.open .group-title::before { transform: rotate(90deg); }
  .collapsible-body { display: none; }
  .collapsible-body.open { display: block; }

  /* ── Annotations Panel ── */
  .annotations-panel {
    margin-top: 16px;
    border-top: 1px solid #222;
    padding-top: 12px;
  }
  .annotations-panel .group-title { color: #c0392b; }
  .annotations-panel .group-title::after { background: #331a1a; }
  .annotation-item {
    display: flex; align-items: flex-start; gap: 8px;
    padding: 6px 8px; margin-bottom: 6px;
    background: #1c1414; border: 1px solid #331a1a; border-radius: 4px;
    font-size: 11px;
  }
  .annotation-item .ann-target { color: #e67e73; font-weight: 600; white-space: nowrap; }
  .annotation-item .ann-note { color: #aaa; flex: 1; }
  .annotation-item .ann-remove {
    background: none; border: none; color: #555; cursor: pointer; font-size: 13px; padding: 0 2px;
    line-height: 1;
  }
  .annotation-item .ann-remove:hover { color: #c0392b; }
  .clear-annotations-btn {
    background: #1c1414; border: 1px solid #331a1a; border-radius: 4px;
    padding: 4px 10px; color: #e67e73; font-size: 10px; cursor: pointer;
    text-transform: uppercase; letter-spacing: 1px; margin-top: 4px;
  }
  .clear-annotations-btn:hover { background: #2a1a1a; }

  /* ── Preview ── */
  .preview-wrapper { display: flex; flex-direction: column; overflow: hidden; }

  .preview-toolbar {
    display: flex; align-items: center; gap: 8px;
    padding: 8px 16px; background: #111; border-bottom: 1px solid #222;
    font-size: 11px; color: #555;
  }
  .preview-toolbar .device-btn {
    background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 4px 10px; color: #666; font-size: 11px; cursor: pointer; transition: all 0.15s;
  }
  .preview-toolbar .device-btn:hover { border-color: #444; color: #aaa; }
  .preview-toolbar .device-btn.active { border-color: #f5c542; color: #f5c542; }
  .preview-toolbar .separator { width: 1px; height: 16px; background: #222; }
  .preview-toolbar .zoom-label { font-family: 'SF Mono', 'Fira Code', monospace; font-size: 10px; }

  .annotate-btn {
    margin-left: auto;
    background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 4px;
    padding: 4px 10px; color: #666; font-size: 11px; cursor: pointer; transition: all 0.15s;
    display: flex; align-items: center; gap: 4px;
  }
  .annotate-btn:hover { border-color: #c0392b; color: #e67e73; }
  .annotate-btn.active { border-color: #c0392b; background: #1c1414; color: #e67e73; }
  .annotate-btn .dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }

  .preview-area {
    flex: 1; overflow: auto; display: flex; justify-content: center;
    padding: 24px; background: #0a0a0a;
  }

  .device-frame {
    background: #000; border-radius: 12px; overflow: hidden;
    box-shadow: 0 0 0 1px #222, 0 8px 32px rgba(0,0,0,0.5);
    transition: width 0.3s ease, max-width 0.3s ease; flex-shrink: 0;
  }

  .landing-scroll { overflow-y: auto; overflow-x: hidden; height: 600px; position: relative; }

  /* ── Landing Page Preview ── */
  .lp { min-height: 100%; position: relative; }

  /* Annotatable elements */
  [data-annotate] { position: relative; transition: outline 0.15s, outline-offset 0.15s; }
  .annotate-mode [data-annotate] { cursor: crosshair; }
  .annotate-mode [data-annotate]:hover { outline: 2px dashed rgba(230, 126, 115, 0.5); outline-offset: 4px; }
  [data-annotate].annotated { outline: 2px solid #c0392b !important; outline-offset: 4px; }
  [data-annotate].annotated::after {
    content: attr(data-ann-index);
    position: absolute; top: -6px; right: -6px;
    width: 16px; height: 16px; background: #c0392b; color: #fff;
    font-size: 9px; font-weight: 700; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-family: -apple-system, sans-serif; z-index: 50;
  }

  /* Annotation input popup */
  .ann-popup {
    position: fixed; z-index: 1000;
    background: #1c1414; border: 1px solid #c0392b; border-radius: 6px;
    padding: 8px; display: none; box-shadow: 0 4px 16px rgba(0,0,0,0.5);
  }
  .ann-popup input {
    background: #111; border: 1px solid #331a1a; border-radius: 4px;
    padding: 6px 8px; color: #e67e73; font-size: 12px; width: 220px;
    font-family: inherit;
  }
  .ann-popup input:focus { outline: none; border-color: #c0392b; }
  .ann-popup .ann-hint { font-size: 9px; color: #555; margin-top: 4px; text-align: center; }

  /* ── Nav Bar ── */
  .lp-navbar {
    display: flex; justify-content: center;
    padding: 16px 24px;
  }
  .lp-navbar-links { display: flex; gap: 24px; }
  .lp-navbar-link {
    font-size: 10px; font-weight: 600; text-transform: uppercase;
    letter-spacing: 1.5px; text-decoration: none;
    opacity: 0.4; transition: opacity 0.2s; cursor: pointer;
  }
  .lp-navbar-link:hover { opacity: 0.8; }

  /* ── Header ── */
  .lp-header {
    display: flex; flex-direction: row; align-items: flex-end;
    padding: 28px 32px 20px;
    gap: 24px;
  }
  .lp-header-left { flex: 1; min-width: 0; }
  .lp-header-right {
    flex-shrink: 0; text-align: right;
    display: flex; flex-direction: column; align-items: flex-end;
  }
  .lp-motto {
    font-size: 11px; font-style: italic;
    letter-spacing: 0.5px; margin-bottom: 0;
    opacity: 0.6; max-width: 240px; line-height: 1.6;
    text-align: right;
  }
  .lp-motto-author {
    display: block; font-style: normal;
    font-size: 8px; letter-spacing: 2px;
    text-transform: uppercase; margin-top: 4px;
    opacity: 0.5;
  }
  .lp-title {
    font-weight: 900; letter-spacing: -1.5px; line-height: 1.05;
    margin-bottom: 4px;
  }
  .lp-subtitle {
    font-size: 12px; line-height: 1.6; opacity: 0.4;
  }

  /* ── Projects Grid ── */
  .lp-projects {
    padding: 20px 32px;
    display: flex; flex-direction: column; align-items: stretch;
  }
  .lp-projects-label {
    font-size: 9px; text-transform: uppercase; letter-spacing: 3px;
    opacity: 0.25; margin-bottom: 14px;
  }
  .lp-projects-grid {
    display: flex; gap: 12px; justify-content: flex-start;
    flex-wrap: wrap; width: 100%;
  }
  .lp-project-card {
    flex: 1 1 180px; max-width: 320px; border-radius: 10px; overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: default; position: relative;
  }
  .lp-project-card:hover { transform: translateY(-3px); }
  .lp-project-card-visual {
    width: 100%; height: 110px; position: relative; overflow: hidden;
  }
  .lp-project-card-visual canvas {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
  }
  .lp-project-card-body { padding: 10px 12px; }
  .lp-project-card-name { font-size: 12px; font-weight: 800; margin-bottom: 3px; }
  .lp-project-card-desc { font-size: 9px; opacity: 0.4; line-height: 1.4; margin-bottom: 8px; }
  .lp-project-card-cta {
    display: inline-block; padding: 5px 14px; border: 1px solid currentColor;
    text-decoration: none; font-size: 9px; font-weight: 700; letter-spacing: 1px;
    text-transform: uppercase; border-radius: 4px; transition: all 0.2s; cursor: pointer;
    opacity: 0.7;
  }
  .lp-project-card-cta:hover { opacity: 1; }

  .lp-project-card-soon {
    width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    font-size: 9px; text-transform: uppercase; letter-spacing: 2px; opacity: 0.15;
  }

  /* ── Blog Section ── */
  .lp-blog-section {
    padding: 0 32px; display: flex; flex-direction: column;
    align-items: stretch;
  }
  .lp-blog-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 14px;
  }
  .lp-blog-label {
    font-size: 9px; text-transform: uppercase; letter-spacing: 3px;
    opacity: 0.25; margin-bottom: 0;
  }
  .lp-blog-more {
    font-size: 10px; font-weight: 600; text-decoration: none;
    letter-spacing: 1px; text-transform: uppercase;
    opacity: 0.5; transition: opacity 0.2s; cursor: pointer;
  }
  .lp-blog-more:hover { opacity: 0.9; }
  .lp-blog-deck {
    display: flex; gap: 12px; justify-content: flex-start;
    flex-wrap: wrap; width: 100%;
  }
  .lp-blog-card {
    flex: 1 1 0; min-width: 140px; min-height: 160px; padding: 14px 12px;
    border-radius: 10px; text-align: left;
    display: flex; flex-direction: column;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer; overflow: hidden;
  }
  .lp-blog-card:hover { transform: translateY(-4px) scale(1.02); }
  .lp-blog-card.pinned-card { flex: 1 1 100%; min-height: auto; }
  .lp-blog-card-title { font-size: 13px; font-weight: 700; margin-bottom: 4px; line-height: 1.3; }
  .lp-blog-card-date { font-size: 9px; opacity: 0.3; margin-bottom: 6px; letter-spacing: 0.5px; }
  .lp-blog-card-excerpt { font-size: 10px; opacity: 0.4; line-height: 1.5; flex: 1; }
  .lp-blog-card-pin {
    font-size: 8px; text-transform: uppercase; letter-spacing: 1px;
    font-weight: 700; margin-bottom: 4px;
  }

  /* Footer */
  .lp-footer { text-align: center; font-size: 11px; opacity: 0.15; }
  .lp-footer a { text-decoration: none; opacity: 0.6; }

  /* ── Prompt ── */
  .prompt-area {
    grid-column: 2; background: #111; border-top: 1px solid #222;
    padding: 12px 20px; display: flex; align-items: flex-start; gap: 12px;
    max-height: 180px; overflow: auto;
  }
  .prompt-text {
    flex: 1; font-family: 'SF Mono', 'Fira Code', monospace;
    font-size: 11px; line-height: 1.6; color: #777; white-space: pre-wrap;
  }
  .copy-btn {
    background: #f5c542; color: #111; border: none; border-radius: 4px;
    padding: 6px 14px; font-size: 11px; font-weight: 700; cursor: pointer;
    white-space: nowrap; transition: opacity 0.15s; flex-shrink: 0;
  }
  .copy-btn:hover { opacity: 0.85; }
</style>
</head>
<body>

<!-- ═══════════ Controls ═══════════ -->
<div class="controls">
  <div class="panel-header">
    <h1>Landing Page</h1>
    <span class="version">hippogriff.io</span>
  </div>

  <!-- Presets -->
  <div class="group">
    <div class="group-title">Page Presets</div>
    <div class="presets">
      <button class="preset-btn active" onclick="applyPreset('editorial')">Editorial</button>
      <button class="preset-btn" onclick="applyPreset('bold')">Bold</button>
      <button class="preset-btn" onclick="applyPreset('cinematic')">Cinematic</button>
      <button class="preset-btn" onclick="applyPreset('minimal')">Minimal</button>
      <button class="preset-btn" onclick="applyPreset('inverted')">Inverted</button>
    </div>
  </div>

  <div class="swatch-strip" id="swatchStrip"><div></div><div></div><div></div></div>

  <!-- Colors -->
  <div class="group">
    <div class="group-title">Palette</div>
    <div class="control">
      <label>Background <span class="val" id="bgVal"></span></label>
      <div class="color-row">
        <input type="color" id="bgColor" oninput="onColorInput('bg', this.value)">
        <input type="text" id="bgHex" oninput="onHexInput('bg', this.value)" maxlength="7">
      </div>
    </div>
    <div class="control">
      <label>Accent <span class="val" id="accentVal"></span></label>
      <div class="color-row">
        <input type="color" id="accentColor" oninput="onColorInput('accent', this.value)">
        <input type="text" id="accentHex" oninput="onHexInput('accent', this.value)" maxlength="7">
      </div>
    </div>
    <div class="control">
      <label>Text <span class="val" id="textVal"></span></label>
      <div class="color-row">
        <input type="color" id="textColor" oninput="onColorInput('text', this.value)">
        <input type="text" id="textHex" oninput="onHexInput('text', this.value)" maxlength="7">
      </div>
    </div>
  </div>

  <!-- Header -->
  <div class="group">
    <div class="group-title">Header</div>
    <div class="control">
      <label>Title Size <span class="val" id="titleSizeVal"></span></label>
      <input type="range" id="titleSize" min="36" max="96" value="72" oninput="state.titleSize = +this.value; updateAll()">
    </div>
    <div class="control">
      <label>Title Weight <span class="val" id="titleWeightVal"></span></label>
      <input type="range" id="titleWeight" min="300" max="900" step="100" value="800" oninput="state.titleWeight = +this.value; updateAll()">
    </div>
    <div class="toggle-row">
      <label>Show Motto</label>
      <label class="toggle"><input type="checkbox" id="showTagline" checked onchange="state.showTagline = this.checked; updateAll()"><span class="slider"></span></label>
    </div>
  </div>

  <!-- Projects -->
  <div class="group">
    <div class="group-title">Projects</div>
    <div class="toggle-row">
      <label>Card Animations</label>
      <label class="toggle"><input type="checkbox" id="showInvaders" checked onchange="state.showInvaders = this.checked; updateAll()"><span class="slider"></span></label>
    </div>
    <div class="control">
      <label>Card Style</label>
      <select id="projectCardStyle" onchange="state.projectCardStyle = this.value; updateAll()">
        <option value="outline">Outline</option>
        <option value="glass" selected>Glass</option>
        <option value="solid">Solid</option>
      </select>
    </div>
  </div>

  <!-- Blog -->
  <div class="group">
    <div class="group-title">Blog Section</div>
    <div class="toggle-row">
      <label>Show Blog</label>
      <label class="toggle"><input type="checkbox" id="showBlog" checked onchange="state.showBlog = this.checked; updateAll()"><span class="slider"></span></label>
    </div>
    <div class="control">
      <label>Blog Display</label>
      <select id="blogDisplay" onchange="state.blogDisplay = this.value; updateAll()">
        <option value="pinned">Pinned Article (featured)</option>
        <option value="latest" selected>Latest Articles (card deck)</option>
      </select>
    </div>
    <div class="control">
      <label>Card Count <span class="val" id="blogCountVal"></span></label>
      <input type="range" id="blogCount" min="2" max="6" value="4" oninput="state.blogCount = +this.value; updateAll()">
    </div>
    <div class="control">
      <label>Card Style</label>
      <select id="blogCardStyle" onchange="state.blogCardStyle = this.value; updateAll()">
        <option value="outline">Outline</option>
        <option value="glass" selected>Glass</option>
        <option value="minimal">Minimal</option>
      </select>
    </div>
  </div>

  <!-- Spacing -->
  <div class="collapsible-header" onclick="toggleCollapsible(this)">
    <div class="group-title">Spacing & Layout</div>
  </div>
  <div class="collapsible-body">
    <div class="group" style="margin-top: 8px;">
      <div class="control">
        <label>Section Gap <span class="val" id="sectionGapVal"></span></label>
        <input type="range" id="sectionGap" min="20" max="120" value="40" oninput="state.sectionGap = +this.value; updateAll()">
      </div>
      <div class="control">
        <label>Content Max Width <span class="val" id="contentWidthVal"></span></label>
        <input type="range" id="contentWidth" min="480" max="900" value="600" oninput="state.contentWidth = +this.value; updateAll()">
      </div>
      <div class="control">
        <label>Footer Style</label>
        <select id="footerStyle" onchange="state.footerStyle = this.value; updateAll()">
          <option value="minimal">Minimal (text only)</option>
          <option value="links" selected>With Links</option>
          <option value="hidden">Hidden</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="collapsible-header" onclick="toggleCollapsible(this)">
    <div class="group-title">Content</div>
  </div>
  <div class="collapsible-body">
    <div class="group" style="margin-top: 8px;">
      <div class="control">
        <label>Motto</label>
        <input type="text" class="text-input" id="taglineInput" value="Be kind, build something great. - Vicki Zhang" oninput="state.tagline = this.value; updateAll()">
      </div>
      <div class="control">
        <label>Title</label>
        <input type="text" class="text-input" id="titleInput" value="Hippogriff" oninput="state.title = this.value; updateAll()">
      </div>
      <div class="control">
        <label>Subtitle</label>
        <textarea class="text-input" id="subtitleInput" oninput="state.subtitle = this.value; updateAll()">A home for things I built — games, agents, and experiments.</textarea>
      </div>
    </div>
  </div>

  <!-- Annotations list -->
  <div class="annotations-panel" id="annotationsPanel" style="display:none;">
    <div class="group-title">Annotations</div>
    <div id="annotationsList"></div>
    <button class="clear-annotations-btn" onclick="clearAnnotations()">Clear All</button>
  </div>
</div>

<!-- ═══════════ Preview ═══════════ -->
<div class="preview-wrapper">
  <div class="preview-toolbar">
    <button class="device-btn active" onclick="setDevice('desktop', this)">Desktop</button>
    <button class="device-btn" onclick="setDevice('tablet', this)">Tablet</button>
    <button class="device-btn" onclick="setDevice('mobile', this)">Mobile</button>
    <div class="separator"></div>
    <span class="zoom-label" id="zoomLabel">100%</span>
    <button class="annotate-btn" id="annotateBtn" onclick="toggleAnnotateMode()">
      <span class="dot"></span> Annotate
    </button>
  </div>

  <div class="preview-area" id="previewArea">
    <div class="device-frame" id="deviceFrame">
      <div class="landing-scroll" id="landingScroll">
        <div class="lp" id="lp">

          <!-- Nav Bar -->
          <nav class="lp-navbar" id="lpNavbar" data-annotate="Navigation">
            <div class="lp-navbar-links">
              <a class="lp-navbar-link">Home</a>
              <a class="lp-navbar-link">Project</a>
              <a class="lp-navbar-link">Blog</a>
              <a class="lp-navbar-link">Contact</a>
            </div>
          </nav>

          <!-- Header: Title left, Motto right -->
          <header class="lp-header" id="lpHeader" data-annotate="Header">
            <div class="lp-header-left">
              <div class="lp-title" id="lpTitle" data-annotate="Title"></div>
              <div class="lp-subtitle" id="lpSubtitle" data-annotate="Subtitle"></div>
            </div>
            <div class="lp-header-right">
              <div class="lp-motto" id="lpMotto" data-annotate="Motto"></div>
            </div>
          </header>

          <!-- Projects -->
          <section class="lp-projects" id="lpProjects" data-annotate="Projects">
            <div class="lp-projects-label">projects</div>
            <div class="lp-projects-grid" id="lpProjectsGrid"></div>
          </section>

          <!-- Blog Section -->
          <section class="lp-blog-section" id="lpBlogSection" data-annotate="Blog Section">
            <div class="lp-blog-header">
              <div class="lp-blog-label" id="lpBlogLabel">writing</div>
              <a class="lp-blog-more" id="lpBlogMore">See more &rarr;</a>
            </div>
            <div class="lp-blog-deck" id="lpBlogDeck"></div>
          </section>

          <!-- Footer -->
          <div class="lp-footer" id="lpFooter" data-annotate="Footer"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Annotation popup -->
  <div class="ann-popup" id="annPopup">
    <input type="text" id="annInput" placeholder="What's wrong with this?" onkeydown="if(event.key==='Enter')submitAnnotation()">
    <div class="ann-hint">Enter to save, Esc to cancel</div>
  </div>

  <!-- Prompt -->
  <div class="prompt-area">
    <div class="prompt-text" id="promptText"></div>
    <button class="copy-btn" id="copyBtn" onclick="copyPrompt()">Copy Prompt</button>
  </div>
</div>

<script>
// ── State ──
const DEFAULTS = {
  bg: '#111111', accent: '#e8a830', text: '#c8c0b0',
  titleSize: 72, titleWeight: 800,
  showTagline: true, showInvaders: true,
  projectCardStyle: 'glass',
  showBlog: true, blogDisplay: 'latest', blogCount: 4, blogCardStyle: 'glass',
  sectionGap: 40, contentWidth: 600, footerStyle: 'links',
  tagline: 'Be kind, build something great. - Vicki Zhang',
  title: 'Hippogriff',
  subtitle: 'A home for things I built — games, agents, and experiments.',
  device: 'desktop'
};

const PRESETS = {
  editorial: {
    bg: '#111111', accent: '#e8a830', text: '#c8c0b0',
    titleSize: 72, titleWeight: 800,
    showTagline: true, showInvaders: true, projectCardStyle: 'glass',
    showBlog: true, blogDisplay: 'latest', blogCount: 4, blogCardStyle: 'glass',
    sectionGap: 40, contentWidth: 600, footerStyle: 'links'
  },
  bold: {
    bg: '#0d0d0d', accent: '#f5c542', text: '#f0ece2',
    titleSize: 88, titleWeight: 900,
    showTagline: false, showInvaders: true, projectCardStyle: 'solid',
    showBlog: true, blogDisplay: 'latest', blogCount: 6, blogCardStyle: 'glass',
    sectionGap: 32, contentWidth: 700, footerStyle: 'minimal'
  },
  cinematic: {
    bg: '#111111', accent: '#e8a830', text: '#c8c0b0',
    titleSize: 72, titleWeight: 800,
    showTagline: true, showInvaders: true, projectCardStyle: 'glass',
    showBlog: true, blogDisplay: 'latest', blogCount: 4, blogCardStyle: 'glass',
    sectionGap: 48, contentWidth: 600, footerStyle: 'links'
  },
  minimal: {
    bg: '#1a1a1a', accent: '#f5c542', text: '#f0ece2',
    titleSize: 52, titleWeight: 700,
    showTagline: true, showInvaders: false, projectCardStyle: 'outline',
    showBlog: true, blogDisplay: 'latest', blogCount: 3, blogCardStyle: 'minimal',
    sectionGap: 28, contentWidth: 560, footerStyle: 'hidden'
  },
  inverted: {
    bg: '#f0ece2', accent: '#c8960a', text: '#1a1a1a',
    titleSize: 60, titleWeight: 900,
    showTagline: true, showInvaders: true, projectCardStyle: 'outline',
    showBlog: true, blogDisplay: 'pinned', blogCount: 4, blogCardStyle: 'outline',
    sectionGap: 36, contentWidth: 640, footerStyle: 'links'
  }
};

const state = { ...DEFAULTS };

const PROJECTS = [
  { id: 'typecraft', name: 'TypeCraft', desc: 'A Space Invaders typing game that finds your weak keys', url: 'https://typecraft.hippogriff.io', hasAnimation: true },
];

const MOCK_POSTS = [
  { title: 'Why I built TypeCraft', date: 'Jan 28, 2026', excerpt: 'Typing speed tests are boring. I wanted something that finds your actual weak keys...', pinned: true },
  { title: 'Scroll animations without libraries', date: 'Jan 20, 2026', excerpt: 'IntersectionObserver + requestAnimationFrame is all you need for Apple-level scroll effects.' },
  { title: 'The 3-color constraint', date: 'Jan 12, 2026', excerpt: 'Pluribus taught me that restraint is a superpower. Three colors, maximum impact.' },
  { title: 'Shipping fast as a solo maker', date: 'Jan 5, 2026', excerpt: 'How I go from idea to deployed in a weekend, every time.' },
  { title: 'Agents that actually help', date: 'Dec 28, 2025', excerpt: 'Most AI agents are demos. Here\'s how to build ones people use.' },
  { title: 'Design decisions as documentation', date: 'Dec 20, 2025', excerpt: 'Write down why, not what. Your future self will thank you.' },
];

// ── Annotation System ──
let annotateMode = false;
let annotations = [];
let pendingAnnotateTarget = null;

function toggleAnnotateMode() {
  annotateMode = !annotateMode;
  document.getElementById('annotateBtn').classList.toggle('active', annotateMode);
  document.getElementById('lp').classList.toggle('annotate-mode', annotateMode);
}

function handleAnnotateClick(e) {
  if (!annotateMode) return;
  const target = e.target.closest('[data-annotate]');
  if (!target) return;
  e.preventDefault();
  e.stopPropagation();
  pendingAnnotateTarget = target.getAttribute('data-annotate');
  const popup = document.getElementById('annPopup');
  const input = document.getElementById('annInput');
  popup.style.display = 'block';
  popup.style.left = (e.clientX + 10) + 'px';
  popup.style.top = (e.clientY - 20) + 'px';
  input.value = '';
  input.focus();
}

function submitAnnotation() {
  const input = document.getElementById('annInput');
  const note = input.value.trim();
  if (!note || !pendingAnnotateTarget) { closeAnnotationPopup(); return; }
  annotations.push({ target: pendingAnnotateTarget, note });
  const el = document.querySelector(`[data-annotate="${pendingAnnotateTarget}"]`);
  if (el) { el.classList.add('annotated'); el.setAttribute('data-ann-index', annotations.length); }
  closeAnnotationPopup();
  renderAnnotationsList();
  updatePrompt();
}

function closeAnnotationPopup() {
  document.getElementById('annPopup').style.display = 'none';
  pendingAnnotateTarget = null;
}

function removeAnnotation(idx) {
  annotations.splice(idx, 1);
  document.querySelectorAll('[data-annotate]').forEach(el => {
    el.classList.remove('annotated');
    el.removeAttribute('data-ann-index');
  });
  annotations.forEach((a, i) => {
    const el = document.querySelector(`[data-annotate="${a.target}"]`);
    if (el) { el.classList.add('annotated'); el.setAttribute('data-ann-index', i + 1); }
  });
  renderAnnotationsList();
  updatePrompt();
}

function clearAnnotations() {
  annotations = [];
  document.querySelectorAll('[data-annotate]').forEach(el => {
    el.classList.remove('annotated');
    el.removeAttribute('data-ann-index');
  });
  renderAnnotationsList();
  updatePrompt();
}

function renderAnnotationsList() {
  const panel = document.getElementById('annotationsPanel');
  const list = document.getElementById('annotationsList');
  if (annotations.length === 0) { panel.style.display = 'none'; return; }
  panel.style.display = 'block';
  list.innerHTML = annotations.map((a, i) =>
    `<div class="annotation-item">
      <span class="ann-target">${i + 1}. ${a.target}</span>
      <span class="ann-note">${a.note}</span>
      <button class="ann-remove" onclick="removeAnnotation(${i})">&times;</button>
    </div>`
  ).join('');
}

document.addEventListener('keydown', e => { if (e.key === 'Escape') closeAnnotationPopup(); });

// ── Device Sizes ──
const DEVICES = {
  desktop: { width: '100%', maxWidth: '100%', height: 600 },
  tablet: { width: '768px', maxWidth: '768px', height: 600 },
  mobile: { width: '375px', maxWidth: '375px', height: 667 }
};

function setDevice(d, btn) {
  state.device = d;
  document.querySelectorAll('.device-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  updateAll();
}

// ── Color Helpers ──
function onColorInput(key, val) { state[key] = val; document.getElementById(key + 'Hex').value = val; updateAll(); }
function onHexInput(key, val) {
  if (/^#[0-9a-fA-F]{6}$/.test(val)) { state[key] = val; document.getElementById(key + 'Color').value = val; updateAll(); }
}
function hexToRgba(hex, a) {
  const r = parseInt(hex.slice(1, 3), 16), g = parseInt(hex.slice(3, 5), 16), b = parseInt(hex.slice(5, 7), 16);
  return `rgba(${r},${g},${b},${a})`;
}

// ── Presets ──
function applyPreset(name) {
  const p = PRESETS[name];
  if (!p) return;
  Object.keys(p).forEach(k => { state[k] = p[k]; });
  syncControls();
  updateAll();
  document.querySelectorAll('.presets .preset-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
}

function syncControls() {
  ['bg', 'accent', 'text'].forEach(k => {
    document.getElementById(k + 'Color').value = state[k];
    document.getElementById(k + 'Hex').value = state[k];
  });
  document.getElementById('titleSize').value = state.titleSize;
  document.getElementById('titleWeight').value = state.titleWeight;
  document.getElementById('showTagline').checked = state.showTagline;
  document.getElementById('showInvaders').checked = state.showInvaders;
  document.getElementById('projectCardStyle').value = state.projectCardStyle;
  document.getElementById('showBlog').checked = state.showBlog;
  document.getElementById('blogDisplay').value = state.blogDisplay;
  document.getElementById('blogCount').value = state.blogCount;
  document.getElementById('blogCardStyle').value = state.blogCardStyle;
  document.getElementById('sectionGap').value = state.sectionGap;
  document.getElementById('contentWidth').value = state.contentWidth;
  document.getElementById('footerStyle').value = state.footerStyle;
}

function toggleCollapsible(header) {
  header.classList.toggle('open');
  header.nextElementSibling.classList.toggle('open');
}

// ── Mini Invader Animation (card-level) ──
const CHARS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
const INVADER_PATTERNS = [
  [0,0,1,0,0,1,0,0, 0,0,0,1,1,0,0,0, 0,0,1,1,1,1,0,0, 0,1,1,0,0,1,1,0, 1,1,1,1,1,1,1,1, 1,0,1,1,1,1,0,1, 1,0,1,0,0,1,0,1, 0,0,0,1,1,0,0,0],
  [0,0,0,1,1,0,0,0, 0,0,1,1,1,1,0,0, 0,1,1,1,1,1,1,0, 1,1,0,1,1,0,1,1, 1,1,1,1,1,1,1,1, 0,0,1,0,0,1,0,0, 0,1,0,1,1,0,1,0, 1,0,1,0,0,1,0,1],
  [0,0,1,0,0,1,0,0, 0,0,0,1,1,0,0,0, 0,1,1,1,1,1,1,0, 1,1,0,1,1,0,1,1, 1,1,1,1,1,1,1,1, 0,1,1,1,1,1,1,0, 0,0,1,0,0,1,0,0, 0,1,0,0,0,0,1,0],
];

class MiniInvader {
  constructor(cw, ch) {
    this.x = Math.random() * cw;
    this.y = -20;
    this.char = CHARS[Math.floor(Math.random() * CHARS.length)];
    this.pattern = INVADER_PATTERNS[Math.floor(Math.random() * 3)];
    this.speed = 0.15 + Math.random() * 0.25;
    this.wobble = Math.random() * Math.PI * 2;
    this.wobbleSpeed = 0.005 + Math.random() * 0.008;
    this.size = 14 + Math.floor(Math.random() * 8);
    this.opacity = 0.25 + Math.random() * 0.35;
    this.alive = true;
    this.ch = ch;
  }
  update() {
    this.y += this.speed;
    this.wobble += this.wobbleSpeed;
    this.x += Math.sin(this.wobble) * 0.3;
    if (this.y > this.ch + 30) this.alive = false;
  }
  draw(ctx, accent, text) {
    ctx.save();
    ctx.globalAlpha = this.opacity;
    const px = this.size / 8, ox = this.x - this.size / 2, oy = this.y - this.size / 2;
    for (let i = 0; i < 64; i++) {
      if (this.pattern[i]) {
        ctx.fillStyle = accent;
        ctx.fillRect(ox + (i % 8) * px, oy + Math.floor(i / 8) * px, px - 0.5, px - 0.5);
      }
    }
    ctx.globalAlpha = Math.min(1, this.opacity + 0.2);
    ctx.fillStyle = text;
    ctx.font = `900 ${this.size * 0.5}px 'Courier New', monospace`;
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.strokeStyle = 'rgba(0,0,0,0.6)'; ctx.lineWidth = 1.5;
    ctx.strokeText(this.char, this.x, this.y);
    ctx.fillText(this.char, this.x, this.y);
    ctx.restore();
  }
}

let miniInvaders = [];
let miniCanvas = null;
let miniCtx = null;
let miniAnimating = false;
let lastMiniSpawn = 0;

function spawnMiniInvader(now) {
  if (!miniCanvas) return;
  const rate = 1200;
  if (now - lastMiniSpawn > rate) {
    miniInvaders.push(new MiniInvader(miniCanvas.width, miniCanvas.height));
    lastMiniSpawn = now;
  }
}

function animateMiniInvaders(now) {
  if (!miniCanvas || !miniCtx) return;
  miniCtx.clearRect(0, 0, miniCanvas.width, miniCanvas.height);
  spawnMiniInvader(now);
  miniInvaders.forEach(inv => { inv.update(); inv.draw(miniCtx, state.accent, state.text); });
  miniInvaders = miniInvaders.filter(inv => inv.alive);
  if (miniAnimating) requestAnimationFrame(animateMiniInvaders);
}

function startMiniAnimation() {
  miniCanvas = document.getElementById('typecraftCanvas');
  if (!miniCanvas) return;
  miniCtx = miniCanvas.getContext('2d');
  miniCanvas.width = miniCanvas.offsetWidth * 2;
  miniCanvas.height = miniCanvas.offsetHeight * 2;
  miniCtx.scale(2, 2);
  miniAnimating = true;
  miniInvaders = [];
  requestAnimationFrame(animateMiniInvaders);
}

function stopMiniAnimation() {
  miniAnimating = false;
  miniInvaders = [];
  if (miniCtx && miniCanvas) miniCtx.clearRect(0, 0, miniCanvas.width, miniCanvas.height);
}

// Handle annotate clicks on preview
document.getElementById('lp').addEventListener('click', handleAnnotateClick);

// ── Render ──
function renderPreview() {
  const lp = document.getElementById('lp');
  const frame = document.getElementById('deviceFrame');
  const scroll = document.getElementById('landingScroll');
  const dev = DEVICES[state.device];

  frame.style.width = dev.width;
  frame.style.maxWidth = dev.maxWidth;
  scroll.style.height = dev.height + 'px';
  document.getElementById('zoomLabel').textContent = state.device === 'mobile' ? '375px' : state.device === 'tablet' ? '768px' : '100%';

  lp.style.background = state.bg;
  lp.style.color = state.text;
  lp.style.fontFamily = "'Inter', -apple-system, sans-serif";

  // Nav bar
  document.querySelectorAll('.lp-navbar-link').forEach(link => {
    link.style.color = state.text;
  });

  // Header: Motto + Title
  const mottoEl = document.getElementById('lpMotto');
  if (state.showTagline) {
    const parts = state.tagline.split('-').map(s => s.trim());
    mottoEl.innerHTML = `"${parts[0]}"${parts[1] ? `<span class="lp-motto-author">— ${parts[1]}</span>` : ''}`;
    mottoEl.style.color = state.accent;
    mottoEl.style.display = 'block';
  } else {
    mottoEl.style.display = 'none';
  }

  const titleEl = document.getElementById('lpTitle');
  titleEl.textContent = state.title;
  titleEl.style.fontSize = state.titleSize + 'px';
  titleEl.style.fontWeight = state.titleWeight;
  titleEl.style.color = state.text;

  document.getElementById('lpSubtitle').textContent = state.subtitle;
  document.getElementById('lpSubtitle').style.color = state.text;

  // Projects
  const projectsSection = document.getElementById('lpProjects');
  projectsSection.style.paddingTop = state.sectionGap + 'px';
  document.querySelector('.lp-projects-label').style.color = state.accent;

  const grid = document.getElementById('lpProjectsGrid');
  grid.innerHTML = '';
  stopMiniAnimation();

  PROJECTS.forEach(proj => {
    const card = document.createElement('div');
    card.className = 'lp-project-card';
    card.setAttribute('data-annotate', proj.name);

    // Card styling
    if (state.projectCardStyle === 'glass') {
      card.style.background = hexToRgba(state.accent, 0.06);
      card.style.border = `2px solid ${hexToRgba(state.accent, 0.12)}`;
    } else if (state.projectCardStyle === 'solid') {
      card.style.background = hexToRgba(state.accent, 0.1);
      card.style.border = `2px solid ${hexToRgba(state.accent, 0.2)}`;
    } else {
      card.style.background = 'transparent';
      card.style.border = `2px solid ${hexToRgba(state.accent, 0.35)}`;
    }

    const visual = document.createElement('div');
    visual.className = 'lp-project-card-visual';
    visual.style.background = hexToRgba(state.accent, 0.03);

    if (proj.hasAnimation && state.showInvaders) {
      const canvas = document.createElement('canvas');
      canvas.id = 'typecraftCanvas';
      canvas.style.width = '100%';
      canvas.style.height = '100%';
      visual.appendChild(canvas);
    } else {
      visual.style.background = hexToRgba(state.accent, 0.06);
    }

    const body = document.createElement('div');
    body.className = 'lp-project-card-body';
    body.innerHTML = `
      <div class="lp-project-card-name" style="color:${state.accent}">${proj.name}</div>
      <div class="lp-project-card-desc" style="color:${state.text}">${proj.desc}</div>
      <span class="lp-project-card-cta" style="color:${state.accent}">Play</span>
    `;

    card.appendChild(visual);
    card.appendChild(body);
    grid.appendChild(card);
  });

  // Start TypeCraft card animation after DOM update
  if (state.showInvaders) {
    requestAnimationFrame(() => startMiniAnimation());
  }

  // Blog Section
  const blogSection = document.getElementById('lpBlogSection');
  if (!state.showBlog) {
    blogSection.style.display = 'none';
  } else {
    blogSection.style.display = 'flex';
    blogSection.style.paddingTop = state.sectionGap + 'px';
    blogSection.style.paddingBottom = state.sectionGap + 'px';
    document.getElementById('lpBlogLabel').style.color = state.accent;
    const blogMore = document.getElementById('lpBlogMore');
    blogMore.style.color = state.accent;

    const deck = document.getElementById('lpBlogDeck');
    deck.innerHTML = '';

    if (state.blogDisplay === 'pinned') {
      const post = MOCK_POSTS[0];
      const card = document.createElement('div');
      card.className = 'lp-blog-card pinned-card';
      card.setAttribute('data-annotate', 'Pinned Post');
      applyBlogCardStyle(card);
      card.innerHTML = `
        <div class="lp-blog-card-pin" style="color:${state.accent}">pinned</div>
        <div class="lp-blog-card-title" style="color:${state.text}">${post.title}</div>
        <div class="lp-blog-card-date">${post.date}</div>
        <div class="lp-blog-card-excerpt">${post.excerpt}</div>
      `;
      deck.appendChild(card);
    } else {
      const count = Math.min(state.blogCount, MOCK_POSTS.length);
      for (let i = 0; i < count; i++) {
        const post = MOCK_POSTS[i];
        const card = document.createElement('div');
        card.className = 'lp-blog-card';
        card.setAttribute('data-annotate', `Blog Card ${i + 1}`);
        applyBlogCardStyle(card);
        card.innerHTML = `
          <div class="lp-blog-card-title" style="color:${state.text}">${post.title}</div>
          <div class="lp-blog-card-date">${post.date}</div>
          <div class="lp-blog-card-excerpt">${post.excerpt}</div>
        `;
        deck.appendChild(card);
      }
    }
  }

  // Footer
  const footer = document.getElementById('lpFooter');
  footer.style.padding = `${state.sectionGap}px 24px`;
  footer.style.color = state.text;
  if (state.footerStyle === 'hidden') {
    footer.style.display = 'none';
  } else {
    footer.style.display = 'block';
    footer.innerHTML = state.footerStyle === 'links'
      ? `<a href="#" style="color:${state.accent}">github</a> &middot; built with love`
      : 'built with love';
  }

  // Swatches & labels
  const strip = document.getElementById('swatchStrip');
  strip.children[0].style.background = state.bg;
  strip.children[1].style.background = state.accent;
  strip.children[2].style.background = state.text;
  document.getElementById('bgVal').textContent = state.bg;
  document.getElementById('accentVal').textContent = state.accent;
  document.getElementById('textVal').textContent = state.text;
  document.getElementById('titleSizeVal').textContent = state.titleSize + 'px';
  document.getElementById('titleWeightVal').textContent = state.titleWeight;
  document.getElementById('sectionGapVal').textContent = state.sectionGap + 'px';
  document.getElementById('contentWidthVal').textContent = state.contentWidth + 'px';
  document.getElementById('blogCountVal').textContent = state.blogCount;
}

function applyBlogCardStyle(card) {
  const cs = state.blogCardStyle;
  if (cs === 'glass') {
    card.style.background = hexToRgba(state.accent, 0.08);
    card.style.border = `2px solid ${hexToRgba(state.accent, 0.15)}`;
    card.style.boxShadow = `0 2px 12px ${hexToRgba(state.accent, 0.06)}`;
  } else if (cs === 'minimal') {
    card.style.background = 'transparent';
    card.style.border = 'none';
    card.style.borderBottom = `1px solid ${hexToRgba(state.text, 0.08)}`;
    card.style.borderRadius = '0';
  } else {
    card.style.background = hexToRgba(state.bg, 0.4);
    card.style.border = `2px solid ${hexToRgba(state.accent, 0.4)}`;
    card.style.boxShadow = `0 2px 8px ${hexToRgba(state.accent, 0.08)}, inset 0 1px 0 ${hexToRgba(state.accent, 0.1)}`;
  }
  if (cs !== 'minimal') card.style.borderRadius = '10px';
}

function updatePrompt() {
  const parts = [];
  parts.push('Build the Hippogriff landing page (hippogriff.io) with these specifications:');
  parts.push('');
  parts.push(`Palette: background ${state.bg}, accent ${state.accent}, text ${state.text}`);
  parts.push('Nav: Home, Project, Blog, Contact');
  parts.push(`Header: motto "${state.tagline}" styled as a quote, title "${state.title}" at ${state.titleSize}px / weight ${state.titleWeight}`);

  const projDesc = ['project cards with links'];
  if (state.showInvaders) projDesc.push('TypeCraft card has contained invader rain animation');
  projDesc.push(`${state.projectCardStyle} card style`);
  parts.push(`Projects: ${projDesc.join(', ')}`);

  if (state.showBlog) {
    const bd = [];
    if (state.blogDisplay === 'pinned') bd.push('pinned article as featured card');
    else bd.push(`up to ${state.blogCount} latest articles as card deck`);
    bd.push(`${state.blogCardStyle} card style`);
    bd.push('markdown files in content/blog/ with frontmatter (title, date, pinned)');
    bd.push('routes: /blog (listing) and /blog/[slug] (post)');
    parts.push(`Blog: ${bd.join(', ')}`);
  }

  if (state.sectionGap !== 40 || state.contentWidth !== 600) {
    parts.push(`Layout: ${state.sectionGap}px section spacing, ${state.contentWidth}px max content width`);
  }
  if (state.footerStyle !== 'links') parts.push(`Footer: ${state.footerStyle}`);

  parts.push('');
  parts.push('Design: No scroll-driven animations. Straightforward flat layout. Projects visible immediately with contained animations per card. The page itself is the portfolio.');

  if (annotations.length > 0) {
    parts.push('');
    parts.push('FEEDBACK — things to change:');
    annotations.forEach((a, i) => {
      parts.push(`  ${i + 1}. [${a.target}] ${a.note}`);
    });
  }

  document.getElementById('promptText').textContent = parts.join('\n');
}

function updateAll() { renderPreview(); updatePrompt(); }

function copyPrompt() {
  navigator.clipboard.writeText(document.getElementById('promptText').textContent).then(() => {
    const btn = document.getElementById('copyBtn');
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy Prompt', 1500);
  });
}

// ── Init ──
syncControls();
updateAll();
</script>
</body>
</html>
